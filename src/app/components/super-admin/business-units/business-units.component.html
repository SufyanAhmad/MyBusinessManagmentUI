<div class="container-fluid my-5">
  <!--  Cold Store business -->
  <div class="business" >
    <div class="business-title mb-3"  >
      Dairy Farm
    </div>
    <div *ngIf="!loading" class="row">
      <div class="col-md-6 col-lg-4 mb-4" *ngFor="let item of dairyFarmUnitList">
        <div class="custom-card"  >
          <div class="d-flex justify-content-between mb-2">
            <div class="profit-sales d-pointer" [routerLink]="['/superAdmin/users',item.businessUnitId]" *ngIf="item.totalUser != 0" >Total User : {{item.totalUser}}</div>
             <div class="profit-sales" *ngIf="item.totalUser == 0" >Total User : {{item.totalUser}}</div>
            <div class="profit-sales  d-pointer" [routerLink]="['/superAdmin/employees',item.businessUnitId]" *ngIf="item.totalEmployee != 0">Total Employee : {{item.totalEmployee}}</div>
            <div class="profit-sales" *ngIf="item.totalEmployee == 0">Total Employee : {{item.totalEmployee}}</div>
          </div>
            <div class="d-flex justify-content-between mb-2">
            <div class="profit-sales">Total Stock In : {{item.totalStockIn}}</div>
            <div class="profit-sales">Total Stock Out : {{item.totalStockOut}}</div>
          </div>
          <div class="d-flex justify-content-center mb-2">
            <div class="profit-sales">Total Pending Item : {{item.totalPendingItems}}</div>
          </div>
          <div class="d-flex justify-content-between">
            <div (click)="setBusinessUnitId(item.businessUnitId,item.name)" [routerLink]="['/dairyFarm/animal']" class="profit-sales" style="font-size: 20px;cursor:pointer;max-width:250px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" title="{{item.name}}">{{ item.name }}</div>
            <div *ngIf="isAdminExit" class="mt d-flex gap-2">
              <svg style="color: red;cursor:pointer;" (click)="businessUnitId=item.businessUnitId; showConfirmDialog = true;" xmlns="http://www.w3.org/2000/svg"  width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6q-.425 0-.712-.288T4 5t.288-.712T5 4h4q0-.425.288-.712T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5t-.288.713T19 6v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zm-7 11q.425 0 .713-.288T11 16V9q0-.425-.288-.712T10 8t-.712.288T9 9v7q0 .425.288.713T10 17m4 0q.425 0 .713-.288T15 16V9q0-.425-.288-.712T14 8t-.712.288T13 9v7q0 .425.288.713T14 17M7 6v13z"/></svg>

              <svg (click)="isEditVisible=true;businessUnitId=item.businessUnitId;getBusinessUnitDetails();" style="color: #3BA3A5;cursor:pointer;" xmlns="http://www.w3.org/2000/svg" width="25px" height="25px" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="20" stroke-dashoffset="20" d="M3 21h18"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.2s" values="20;0"/></path><path stroke-dasharray="48" stroke-dashoffset="48" d="M7 17v-4l10 -10l4 4l-10 10h-4"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.2s" dur="0.6s" values="48;0"/></path><path stroke-dasharray="8" stroke-dashoffset="8" d="M14 6l4 4"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.8s" dur="0.2s" values="8;0"/></path></g><path fill="currentColor" fill-opacity="0" d="M14 6l4 4L21 7L17 3Z"><animate fill="freeze" attributeName="fill-opacity" begin="1.1s" dur="0.15s" values="0;0.3"/></path></svg>  
            </div>
          </div>
          <div class="profit-sales mt-2" style="font-size: 12px; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; white-space: normal;" title="{{item.location}}">Location : {{ item.location }}</div>
        </div>
      </div>
      <!-- Plus Icon -->
      <div *ngIf="isAdminExit" class="col-md-3 mb-4">
        <div  (click)="visible=true;initForm(3)" class="custom-card  d-flex justify-content-center align-items-center " style="cursor: pointer;background:#11c9cc;min-height: 170px;">
          <svg xmlns="http://www.w3.org/2000/svg" width="40px" height="40px" viewBox="0 0 16 16"><path fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 2v12m6-6H2"/></svg>
        </div>
      </div>
    </div>
    <div *ngIf="loading" class="row">
      <div class="col-4 mb-4">
        <p-skeleton height="100px"></p-skeleton>
      </div>
      <div class="col-4 mb-4">
        <p-skeleton height="100px"></p-skeleton>

      </div>
      <div class="col-4 mb-4">
        <p-skeleton height="100px"></p-skeleton>
      </div>
    </div>
    <app-data-not-found *ngIf="dairyFarmUnitList.length == 0 && !loading" />

  </div>
</div>
<!-- add business unit popup -->
<div class=" flex justify-center">
<p-dialog     header="Add Business Unit" 
    [modal]="true"
  [(visible)]="visible" 
  contentStyleClass="responsive-dialog" [draggable]="false" [resizable]="false"
  >
 <form [formGroup]="addBusinessUnitModel" >
    <div class="row " >
    <div>
      <div class="name">
        <span class="label">Name<span class="required-icon">*</span> </span>
        <input type="text" formControlName="name"   class="input-felid" placeholder="Enter name...">

      </div>
      <div class="mt-3">
        <span class="label">Location<span class="required-icon">*</span></span>
        <input type="text" formControlName="location"   class="input-felid" placeholder="Enter location...">
      </div>
    </div>
    </div>
    <hr class="mt-5">
    <div class="d-flex justify-content-end gap-4 mb-4" style="margin-top: 20px;">
      <button (click)="visible=false"  type="button" class="btn-discard"  
       >
          Discard
          
        </button>
        <button  type="button" (click)="(addBusinessUnitModel.valid && !addLoading)?addBusinessUnit():null"
         [ngClass]="{
        'btn-save': addBusinessUnitModel.valid && !addLoading,
        'btn-disable': addBusinessUnitModel.invalid || addLoading
           }"  >
          Save &nbsp;
           <span *ngIf="addLoading"  class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        </button>
      </div>
</form>
</p-dialog>
</div>
<!-- edit business unit popup -->
 <div class=" flex justify-center">
<p-dialog     header="Edit Business Unit" 
    [modal]="true"
  [(visible)]="isEditVisible" 
  contentStyleClass="responsive-dialog" [draggable]="false" [resizable]="false"
  >
 <form [formGroup]="editBusinessUnitModel" >
    <div class="row " >
    <div>
      <div class="name">
        <span class="label">Name<span class="required-icon">*</span> </span>
        <input *ngIf="!detailLoading" type="text" formControlName="name"   class="input-felid" placeholder="Enter name...">
        <span *ngIf="detailLoading" >
          <p-skeleton height="3rem" />
        </span>
      </div>
      <div class="mt-3">
        <span class="label">Location<span class="required-icon">*</span></span>
        <input *ngIf="!detailLoading" type="text" formControlName="location"   class="input-felid" placeholder="Enter location...">
        <span *ngIf="detailLoading" >
          <p-skeleton height="3rem" />
        </span>
      </div>
       <div class="mt-3">
        <span class="label">Business Type<span class="required-icon">*</span></span>
        <div>
          
        <p-select *ngIf="!detailLoading"
                    [options]="businessTypes" 
                   formControlName="businessTypeId" 
                    optionLabel="type"
                    optionValue="id"
                    placeholder="Business Unit"
                    readonly="true"
                    [styleClass]="'p-select-disabled'"/>
        </div>
        <span *ngIf="detailLoading" >
          <p-skeleton height="3rem" />
        </span>
    </div>
        
    </div>
    </div>
    <hr class="mt-5">
    <div class="d-flex justify-content-end gap-4 mb-4" style="margin-top: 20px;">
      <button (click)="isEditVisible=false"  type="button" class="btn-discard"  
       >
          Discard
          
        </button>
        <button  type="button" (click)="(editBusinessUnitModel.valid && !editLoading)?editBusinessDetail():null"
         [ngClass]="{
        'btn-save': editBusinessUnitModel.valid && !editLoading,
        'btn-disable': editBusinessUnitModel.invalid || editLoading
           }"  >
          Save &nbsp;
           <span *ngIf="editLoading"  class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        </button>
      </div>
</form>
</p-dialog>
</div>
<p-toast />
 <app-confirmation-popup
  [visible]="showConfirmDialog"
  [message]="'Are you sure you want to delete this business unit?'"
  (onConfirm)="deleteBusinessUnit()"
  (onCancel)="handleCancelled()">
</app-confirmation-popup>
